===============
Introduction to Dev Cube
===============

Dev Cube is a chip integrated development tool provided by Boliu, which includes three functions: IOT program download, MCU program download and RF performance test. This document mainly introduces the related configuration of IOT and MCU program download. For RF performance test, please refer to "Radio Frequency Performance Test User Manual".

Dev Cube provides users with the function of downloading programs, and supports the configuration of clock, flash and other parameters. Users can decide whether to encrypt the program, add signatures, and replace the information file, user resource file, partition table and other functional configurations when the program is started according to their own needs. 

The specific functions are as follows:

1. Support download of IOT application and MCU application

2. Supports erasing, writing and reading of various types of Flash;

3. Various files can be downloaded to Flash, verified and read back;

4. The download communication interface supports two methods: UART and JLink.

Users can get the latest version of Dev Cube through `Bouffalo Lab Dev Cube <https://dev.bouffalolab.com/download>`__.
Double-click ``BLDevCube.exe`` in the decompressed folder, select the corresponding chip model in the  ``Chip Selection`` dialog box, and click  ``Finish`` to enter the Dev Cube main interface.

.. figure:: /bl602doc_tool/content/picture/chipselection.png
   :align: center

   Chip selection

==========
Mirror Composition
==========
Regardless of whether it is IOT program download or MCU program download, their mirror composition is the same, as shown in the following figure:

.. figure:: /bl602doc_tool/content/picture/tool2.png
   :align: center

Download content layout

If only downloading the application program cannot make the chip work normally, the boot information must be downloaded to the specified location. The boot information includes the configuration of PLL, Boot, Flash, etc.; the firmware is an application program written by the user.

Take single-core download as an example: select the corresponding parameters according to your needs, burn the configuration information of PLL, Flash, etc. to the address corresponding to Bootinfo Addr, and burn the compiled bin file of the application to the address corresponding to Image Addr in.

=====================
MCU Program Download
=====================
Select the MCU option in the  ``View`` menu, and you will enter the MCU program download interface, which is mainly divided into the configuration of the program download mode, the configuration of mirroring parameters and the configuration of advanced mirroring parameters.

Configuration program download method
====================

- Configuration program download method:

   * Interface: used to select the communication interface for burning, here select Uart to download
   * COM Port: When selecting UART for download, select the COM port number connected to the chip, you can click the Refresh button to refresh the COM number

   * Uart Speed: When selecting UART to download, fill in the baud rate, the recommended download frequency is 2MHz, not too high
   * Chip Erase: The default setting is False, which means that Flash will not be erased when downloading
   * Xtal: Used to select the type of crystal used on the board.

.. figure:: /bl602doc_tool/content/picture/tool5.png
   :align: center

    MCU program download method selection interface

Configure mirroring parameters
==================

- Configuration parameters include:

   * Boot Source: The default is Flash
   * BootInfo Addr: the storage address of Flash program startup parameters, fill in 0x0
   * Image Type: The default is SingleCPU
   * Image Addr: the storage address of the application, it is recommended to fill in the address 0x2000 or after 0x2000
   * Image File: add the bin file path generated by the compilation to the Image File

.. figure:: /bl602doc_tool/content/picture/tool9.png
   :align: center
   
   Mirror parameter selection interface

Configure advanced mirroring parameters
======================

- When you click ``click here to show advanced options``, the advanced mirror configuration will be expanded. The configurable parameters include:

    * Flash Clock: XTAL by default
    * PLL: PLL clock configuration, the default is 160M
    * CacheWayDis: The buffer channel is disabled, the default is none
    * Sign: Choose whether to require ECC verification, the default is none
    * CrcIgnore: Whether CRC check is required. CRC check is required when the parameter is False; CRC check is not required when the parameter is True
    * HashIgnore: Whether to do Hash verification. Hash verification is required when the parameter is False; Hash verification is not required when the parameter is True
    * Encrypt: Select the encryption method, and enter the corresponding values in AES Key and AES IV according to the AES encryption method.

.. figure:: /bl602doc_tool/content/picture/tool10.png
   :align: center

    Advanced mirroring parameter selection interface

Download program
===========

- Keep the BOOT pin of the board high, and reset the chip to make it in the state of UART boot download. Click  ``Creat&Program``, the application image and startup parameter configuration file will be automatically generated, the following log message appears, and the program download is successful

.. figure:: /bl602doc_tool/content/picture/tool6.png
   :align: center

   Download program

.. note::
    If the board is not connected, just generate the application image and startup parameter configuration file, also click the  ``Creat&Program`` button.

- After the download is successful, keep the BOOT pin of the board low and reset the chip to start it from Flash. This example sends a string message to the PC at a baud rate of 2M.

.. figure:: /bl602doc_tool/content/picture/tool7.png
   :align: center

   Log information

=============
IOT program download
=============
Select the IOT option in the ``View`` menu to enter the IOT program download interface, which is mainly divided into the configuration of the program download mode and the configuration of the download parameters.

Configuration program download method
====================

- Configuration parameters include:

    * Interface: used to select the communication interface for burning, here select Uart to download
    * COM Port: When selecting UART for download, select the COM port number connected to the chip, you can click the Refresh button to refresh the COM number
    * Uart Rate: When selecting UART to download, fill in the baud rate, the recommended download frequency is 2MHz, not too high
    * Board: select the board model you are using, here is IoTKitA, when the board is selected, Xtal will automatically update to the default value matching the board, of course the user can also change it again
    * Xtal: Select the crystal oscillator frequency when downloading. If the circuit board does not have a soldered crystal oscillator, the internal RC32M clock source should be selected here
    * Chip Erase is set to False by default, that is, Flash is not erased when downloading

.. figure:: /bl602doc_tool/content/picture/iot1.png
   :align: center
   
    IOT program download method selection interface

Configure download parameters
==================

- Configuration parameters include:

   * Partition Table: Use the partition table in the partition folder of the corresponding chip model in the Dev Cube directory, and 2M files are selected by default
   * Boot2 Bin: It is the first Flash program that runs after the system is started. It is responsible for establishing the BLSP security environment and guiding the main program to run, using the Boot2 file in the builtin_imgs folder of the corresponding chip model in the Dev Cube directory
   * Firmware Bin: Bin file path generated by user compilation
   * Media/Romfs: Choose one of Media and Romfs, if you check Media, the file is selected, if you check Romfs, the folder is selected
   * MFG Bin: select MFG file
   * AES-Encrypt: If you use the encryption function, you need to select the AES-Encrypt option, and enter the Key and IV used for encryption in the text box next to it. The input is "0"~"F" corresponding to hexadecimal, and a Byte is composed of two characters, so Key and IV require 32 characters to be input respectively. It should be noted that the last 8 characters of IV (ie 4Bytes) must be all 0
   * Single Download Config: After you check Enable, you can download a single file. Fill in the starting address of the download in the left text box, starting with 0x

.. figure:: /bl602doc_tool/content/picture/iot2.png
   :align: center

   Download parameter selection interface

Download program
===========

- Keep the BOOT pin of the board high, and reset the chip to make it in the state of UART boot download. Click  ``Creat&Download``, the application image and startup parameter configuration file will be automatically generated, the following log message appears, and the program download is successful

.. figure:: /bl602doc_tool/content/picture/iot3.png
   :align: center

   IOT downloader

.. note::
    If the board is not connected, just generate the application image and startup parameter configuration file, also click the \ ``Creat&Program``\ button

- After the download is successful, keep the BOOT pin of the board low and reset the chip to start it from Flash. This example sends a string message to the PC at a baud rate of 2M

.. figure:: /bl602doc_tool/content/picture/tool7.png
   :align: center

   Log information
